<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: factory.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: factory.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file Generic factory
 * @since 0.1.5
 */
/*#ifndef(UMD)*/
"use strict";
/*global _gpfFunc*/ // Create a new function using the source
/*exported _gpfNewApply*/ // Apply new operator with an array of parameters
/*#endif*/

function _gpfBuildFactoryParameterList (maxParameters) {
    return new Array(maxParameters).join(" ").split(" ").map(function (value, index) {
        return "p" + index;
    });
}

function _gpfGenerateGenericFactorySource (parameters) {
    var src = [
        "var C = this, l = arguments.length;",
        "if (0 === l) { return new C();}"
    ];
    parameters.forEach(function (value, index) {
        var count = index + 1;
        src.push("if (" + count + " === l) { return new C(" + parameters.slice(0, count).join(", ") + ");}");
    });
    return src.join("\r\n");
}

function _gpfGenerateGenericFactory (maxParameters) {
    var parameters = _gpfBuildFactoryParameterList(maxParameters);
    return _gpfFunc(parameters, _gpfGenerateGenericFactorySource(parameters));
}

/**
 * Create any class by passing the right number of parameters
 *
 * @this {Function} constructor to invoke
 * @since 0.1.5
 */
var _gpfGenericFactory = _gpfGenerateGenericFactory(10);

/**
 * Call a constructor with an array of parameters.
 *
 * It is impossible to mix [new](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/new)
 * and [apply](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/apply)
 * in the same call.
 *
 * This helper workarounds this problem.
 *
 * @param {Function} Constructor Class constructor
 * @param {Array} parameters Parameters to pass to the constructor
 * @return {Object} New object
 * @since 0.1.5
 */
function _gpfNewApply (Constructor, parameters) {
    if (parameters.length > _gpfGenericFactory.length) {
        _gpfGenericFactory = _gpfGenerateGenericFactory(parameters.length);
    }
    return _gpfGenericFactory.apply(Constructor, parameters);
}

/*#ifndef(UMD)*/

gpf.internals._gpfNewApply = _gpfNewApply;

/*#endif*/
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="gpf.Error.html">Error</a></li><li><a href="gpf.Error.AbstractMethod.html">AbstractMethod</a></li><li><a href="gpf.Error.AssertionFailed.html">AssertionFailed</a></li><li><a href="gpf.Error.InvalidParameter.html">InvalidParameter</a></li><li><a href="gpf.Error.NotImplemented.html">NotImplemented</a></li></ul><h3>Namespaces</h3><ul><li><a href="gpf.html">gpf</a></li><li><a href="gpf.node.html">node</a></li><li><a href="gpf.web.html">web</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-CODESTYLE.html">CODESTYLE</a></li><li><a href="tutorial-COMPATIBILITY.html">COMPATIBILITY</a></li><li><a href="tutorial-LOADING.html">LOADING</a></li></ul><h3>Global</h3><ul><li><a href="global.html#abstractMethod">abstractMethod</a></li><li><a href="global.html#assertionFailed">assertionFailed</a></li><li><a href="global.html#invalidParameter">invalidParameter</a></li><li><a href="global.html#notImplemented">notImplemented</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Mon Nov 21 2016 23:06:16 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
