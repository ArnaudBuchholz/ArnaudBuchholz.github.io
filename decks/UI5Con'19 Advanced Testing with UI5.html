<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="description" content="UI5Con'19 Advanced Testing with UI5">
		<meta name="author" content="Arnaud Buchholz">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
		<meta name="deck-duration" content="30">
		<link rel="stylesheet" type="text/css" href="styles.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<section>
						<table>
							<tr>
								<td width="50%">
									<small>
										<a href="https://en.wikipedia.org/wiki/Advanced_Test_Reactor">Advanced test reactor
											<img src="UI5Con'19 Advanced Testing with UI5/Advanced_Test_Reactor.jpg" style="margin: 0; border: 0; box-shadow: unset; border-radius: 16px;"></img>
										</a>
									</small>
								</td>
								<td style="vertical-align: top;">
									<h3 data-agenda="no">Advanced <strong>Testing</strong> with <strong>UI5</strong></h3>
									<p>
										<small>
											Presented by <a href="https://github.com/ArnaudBuchholz">Arnaud Buchholz</a>
											<br/>
											Presentation made with <a href="https://github.com/hakimel/reveal.js">Reveal.js</a>
										</small>
									</p>
									<br />
									<img src="UI5Con'18 A journey with OPA/OpenUI5_new_big_side.png" height="75px" style="border: 0;" />
									<img src="UI5Con'18 A journey with OPA/UI5Con.png" height="75px" style="border: 0;" />
								</td>
							</tr>
						</table>
					</section>
					<section include="me.html"></section>
					<section>
						<h3 data-agenda="no"><strong>Agenda</strong></h3>
						<ul id="agenda"></ul>
					</section>
					<section>
						<h4>Presented <img src="/gfx/GitHub.png" style="margin: 0; border: 0; box-shadow: unset;" /><strong>projects</strong></h4>
						<ul>
							<li>
								<a href="https://openui5.org/">OpenUI5</a><br />
								<small>An enterprise-grade, responsive &amp; open source <strong>UI framework</strong></small>
							</li>
							<li>
								<a href="https://github.com/ArnaudBuchholz/training-ui5Con18-opa">training-ui5con18-opa</a><br />
								<small>A <strong>todo list</strong> developed with <strong>OpenUI5</strong> to <strong>illustrate</strong></a> the testing concepts</small>
							</li>
							<li>
								<a href="https://github.com/jsdom/jsdom">jsdom</a><br />
								<small>A JavaScript implementation of the <strong>WHATWG DOM and HTML standards</strong>, for use with <strong>Node.js</strong></small>
							</li>
							<li>
								<a href="https://github.com/ArnaudBuchholz/node-ui5">node-ui5</a><br />
								<small>An <strong>Node.js</strong> wrapper for <strong>OpenUI5</strong>, enabling advanced testing</small>
							</li>
						</ul>
						<p>
						</p>
					</section>
					<section>
						<h4><strong>About</strong> the presentation</h4>
						<ul>
							<li class="fragment">There is <strong>more than UI</strong> in UI5</li>
							<li class="fragment"><a href="https://github.com/SAP/ui5-tooling"><strong>UI5 tooling</strong></a> is the <strong>recommended</strong> solution for UI5 development</li>
							<br />
							<li class="fragment">This presentation is about <strong>unusual ways of leveraging UI5</strong> to test your development</li>
						</ul>
					</section>
				</section>
				<section>
					<section>
						<h3>UI5Con<strong>'18</strong></h3>
					</section>
					<section>
						<img src="From OPA to Node-UI5/UI5Con18.jpg" style="border: 0; max-width: 50%; max-height: 50%;" />
						<br />
						<small><a href="https://openui5.org/ui5con/material2018.html">UI5 sessions 2018</a></small>
						<p><strong>A journey with OPA</strong> at UI5Con<strong>'18</strong></p>
					</section>
					<section>
						<h4>A journey with <strong>O</strong>ne <strong>P</strong>age <strong>A</strong>cceptance</h4>
						<ul>
							<li><strong>UI behavior</strong> testing</li>
							<li><strong>JavaScript</strong> based</li>
							<li>Tightly <strong>integrated</strong> with UI5</li>
							<li><strong>Asynchronous</strong> with <strong>active polling</strong> mechanisms</li>
							<li>Enables <strong>T</strong>est-<strong>D</strong>riven <strong>D</strong>evelopment through <strong>abstractions</strong></li>
						</ul>
					</section>
					<section>
						<h4>What is <strong>OPA</strong>?</h4>
						<p>OPA is a set of tools used to <strong>automate</strong> and <strong>validate</strong> UI
							and it comes with <strong>backend mocking</strong>.</p>
						<br/>
						<p>Tests are organized in <strong>Journeys</strong>, based on <strong>Pages</strong>
							to provide a <strong>readable abstraction</strong> of the UI.</p>
					</section>
					<section>
						<h4>The <strong>need</strong> for a backend</h4>
						<p>When the application has a backend counterpart, it <strong>can't run</strong> without being connected to it.</p>
						<p>However, tests have to rely on a <strong>stable dataset</strong> and some features might be <strong>dangerous</strong>.</p>
					</section>
					<section>
						<h4>Introducing the <strong>MockServer</strong></h4>
						<img src="UI5Con'18 A journey with OPA/MockServer.png" style="border: 0; max-width: 40%; max-height: 40%;" align="left"/>
						<br/>
						<p>The MockServer is a software component that <strong>captures</strong> AJAX requests and either <strong>answer them</strong> or <strong>let them reach</strong> the backend.<p>
					</section>
					<section>
						<h4><strong>DEMO</strong> Automated tests samples</h4>
						<small>
							<a href="http://localhost:8080/index.html">Application</a>
							<a href="http://localhost:8080/test/integration/opaTests.qunit.html">OPA tests</a>
						</small>
					</section>
					<section>
						<h4><strong>Learn</strong> more</h4>
						<br/>
						<a href="https://youtu.be/HiZq-kuIbt0">
							<img src="From OPA to Node-UI5/UI5con@SAP 2018 - A journey with OPA.png" style="border: 0; max-width: 50%; max-height: 50%;" />
						</a>
						<br />
						<small><a href="https://github.com/ArnaudBuchholz/training-ui5con18-opa">training-ui5con18-opa</a></small>
					</section>
				</section>
				<section>
					<section>
						<h3>MockServer as a <strong>real</strong> server</h3>
					</section>
					<section>
						<h4>The <strong>request</strong></h4>
						<p>After UI5Con'18,<br />a <strong>colleague</strong> submitted a strange <strong>request</strong>.<p>
						<br />
						<p>His team needed a <strong>fake ODATA server</strong> to validate an unusual network configuration.</p>
					</section>
					<section>
						<h4>His <strong>prototype</strong></h4>
						<img src="From OPA to Node-UI5/MockServer server old.png" style="border: 0; max-width: 80%; max-height: 60%;" />
					</section>
					<section>
						<q>There must be a better way !</q>
						<p class="fragment">Why not running UI5 <strong>in</strong> Node.js ?</p>
					</section>
					<section>
						<h4>Introducing <strong>jsdom</strong></h4>
						<p>jsdom <strong>simulates</strong> a browser <strong>inside</strong> Node.js.</p>
						<pre><code>const dom = new JSDOM(``, {
  url: "https://example.org/",
  referrer: "https://example.com/",
  contentType: "text/html",
  includeNodeLocations: true,
  storageQuota: 10000000
});</pre></code>
						<small><a href="https://github.com/jsdom/jsdom">https://github.com/jsdom/jsdom</a></small>
					</section>
					<section>
						<h4>jsdom <strong>Challenges</strong></h4>
						<ul>
							<li>No <strong>synchronous</strong> requests</li>
							<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS"><strong>CORS</strong></a></li>
							<li>Environments are <strong>isolated</strong><br />
								<i><small>(not able to run Node.js code in loaded scripts)</small></i></li>
						</ul>
					</section>
					<section>
						<h4>Rewriting <strong>XMLHttpRequest</strong></h4>
						<ul>
							<li>Enables loading of <strong>file system resources</strong></li>
							<li>Remote resources are handled <strong>natively</strong></li>
							<li>Synchronous code is handled with <a href="https://www.npmjs.com/package/deasync"><strong>DeAsync.js</strong></a></li>
						</ul>
					</section>
					<section>
						<h4><strong>DEMO</strong> MockServer server</h4>
						<small>
							<a href="http://localhost:8080/odata/TODO_SRV/$metadata">$metadata</a>
							<a href="http://localhost:8080/index.html?no-mock">Application</a>
						</small>
					</section>
				</section>
				<section>
					<section>
						<h3>UI5 <strong>inside</strong> Node.js</h3>
					</section>
					<section>
						<p>The MockServer <strong>proof of concept</strong> demonstrated
							that it is possible to <strong>run UI5 in Node.js</strong>.</p>
					</section>
					<section>
						<q>What else can we do ?</q>
						<br />
						<q class="fragment">Anything !</q>
					</section>
					<section>
						<h4>Introducing <strong>node-ui5</strong></h4>
						<small><a href="https://www.npmjs.com/package/node-ui5">https://www.npmjs.com/package/node-ui5</a></small>
						<p>node-ui5 <strong>wraps</strong> UI5 API <strong>in</strong> Node.js.</p>
						<pre><code>require('node-ui5').then(({sap}) => {
  sap.ui.require([
    /* module dependencies */
  ], function (/* module values */) {
	  /* ... */
  })
})</pre></code>
					</section>
					<section>
						<h4><strong>Benefits</strong> of running in Node.js</h4>
						<p><strong>Native</strong> access to the <strong>latest JavaScript</strong> features:</p>
						<ul>
							<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">template literals</a></li>
							<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">arrow functions</a> for callbacks</li>
							<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function">async functions</a>,
								<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await">await operator</a></li>
							<li>...</li>
						</ul>
						<p>node-ui5 provides <a href="https://www.npmjs.com/package/node-ui5#node-ui5-helpers"><strong>asynchronous wrappers</strong></a></p>
					</section>
					<section>
						<h4><strong>DEMO</strong> Accessing MockServer server</h4>
						<small><a href="https://github.com/ArnaudBuchholz/training-ui5con18-opa/blob/master/test.js">test.js</a></small>
						<pre><code>require('node-ui5')
  .then(({ sap }) => {
    sap.ui.require([
      'sap/ui/model/odata/v2/ODataModel',
      'node-ui5/promisify'
    ], async function (ODataModel) {
      console.log('Creating ODataModel...')
      const model = new ODataModel({
        serviceUrl: 'http://localhost:8080/odata/TODO_SRV'
      })
      console.log('Reading $metadata')
      await model.metadataLoaded()
      console.log('Reading TODO items')
      const { results } = await model.readAsync('/TodoItemSet')
      console.log(`Found ${results.length} todo items`)
      /* ... */</pre></code>

					</section>
				</section>
				<section>
					<section>
						<h3><strong>OData</strong> testing with UI5</h3>
					</section>
<!-- TODO -->
					<section>
						<div style="white-space: pre; font-size: 1rem; text-align: left;">
						For ODATA testing we tend to test *only* the ODATA layer
						DEMO with POSTMAN
							I skip the authentication part
							$metadata retreive
								how do you validate it?
								What if I want to check that a specific field has a label?
							single request with one result
							single request with multiple results
							batch (write it and analyse it)

							Actually, most of the 'extra' work done in Postman is already done in SapUI5

						considering that an UI5 application is actually more than
						(image of SPA)
							postman.cmd

						When building the mock server it shall be possible to validate the behavior...
							It is even possible to build the mock server before the backend is ready
							And then validate backend behavior (big UP for UI developers)
						</div>
					</section>
				</section>
				<section>
					<section>
						<h3 data-agenda="no"><b>Workshop</b> <strong>Building</strong> a MockServer</h3>
					</section>
					<section>
						<h4>Exposes <strong>predefined</strong> items</h4>
					</section>
					<section>
						<h4>Exposes <strong>more than 100</strong> items</h4>
					</section>
					<section>
						<h4>Handles <strong>update</strong> of item</h4>
					</section>
					<section>
						<h4>Handles <strong>creation</strong> of a new item</h4>
					</section>
					<section>
						<h4>Simulates an <strong>error</strong></h4>
					</section>
					<section>
						<h4>Implements ClearCompleted <strong>function import</strong></h4>
					</section>
				</section>
				<section>
					<section>
						<h3>OPA <strong>end-to-end</strong></h3>
					</section>
					<section>
						<div style="white-space: pre; font-size: 1rem; text-align: left;">
							When building OPA pages, the developper somehow creates a language to manipulate the UI
							It works only if the OPA code and the app is served on the same server
							node-ui5 comes with a server that proxify requests and can 'aggregate' websites
							making the use of OPA code on top of a real system
						</div>
					</section>
				</section>
				<section>
					<h3>Key <strong>Take-Aways</strong></h3>
					<ul>
						<li>There is <strong>more than UI</strong> in UI5</li>
						<li><strong>node-ui5</strong> allows the use of UI5 in Node.js</li>
						<li><i>something about testing</i></li>
						<br />
						<li>Experimenting is <strong>fun</strong> and leads to <strong>new ideas</strong></li>
					</ul>
				</section>
			</div>
		</div>
		<script src="/gpf/0.2.9/gpf.js"></script>
		<script src="training-ui5con18-opa.js"></script>
		<script src="deck.js"></script>
	</body>
</html>
